<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <link rel="shortcut icon" href="https://mongocxx.org/img/favicon.png">

    <title>API and ABI versioning</title>

    <link rel="stylesheet" href="https://mongocxx.org/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="https://mongocxx.org/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="https://mongocxx.org/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="https://mongocxx.org/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="https://mongocxx.org/lib/highlight/styles/idea.css" />

  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="https://mongocxx.org">
        <img src="https://mongocxx.org/img/logo-mongodb-header.png",
             alt="MongoDB C++ driver" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search">
    <input type="hidden" name="site" value="https://mongocxx.org">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="https://mongocxx.org">MongoDB C&#43;&#43; Driver Manual</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
  
  


        
      
    
      
      
        
      
    
    
  


          
            
            









  
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  
    
    
      
      
    
      
      
    
      
      
    
    
  


          

          

          
            
            













  




<li class="toctree-l1  current">
  <a href="/mongocxx-v3/" class="">
      <i class='fa fa-arrow-right'></i>
      <span>mongocxx (v3)</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/polyfill-selection/">
        
        Choosing a C&#43;&#43;17 Polyfill
    </a>
  </li>


        
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongocxx-v3/installation/" class="">
      
      <span>Installing the mongocxx driver</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongocxx-v3/installation/windows/">
        
        Windows
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongocxx-v3/installation/macos/">
        
        macOS
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongocxx-v3/installation/linux/">
        
        Linux
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongocxx-v3/installation/advanced/">
        
        Advanced Configuration and Installation Options
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/configuration/">
        
        Configuring the mongocxx driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/client-side-encryption/">
        
        Client-Side Field Level Encryption with mongocxx
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/tutorial/">
        
        Tutorial for mongocxx
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/thread-safety/">
        
        Thread and fork safety
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/connection-pools/">
        
        Connection pools
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/working-with-bson/">
        
        Working with BSON
    </a>
  </li>


        
        
        
        
        













  




    <li class="toctree-l2">
    <a href="/mongocxx-v3/api-abi-versioning/">
        
        API and ABI versioning
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/">
        
        The mongocxx (v3) driver
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/legacy-v1/" class="">
      <i class='fa fa-arrow-right'></i>
      <span>legacy (v1)</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/installation/">
        
        Installing the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/configuration/">
        
        Configuring the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/tutorial/">
        
        Legacy driver tutorial
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/working-with-bson/">
        
        Working with BSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/breaking-changes/">
        
        Breaking changes from 26compat
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/">
        
        The Legacy C&#43;&#43; Driver
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://mongocxx.org/api/current">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/getting-help/">
        <i class='fa fa-question'></i>
        Getting help
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/reporting-bugs/">
        <i class='fa fa-bug'></i>
        Reporting Bugs
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb/mongo-cxx-driver/">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/contributing/" class="">
      <i class='fa fa-pencil'></i>
      <span>Contributing</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/testing-mongocxx/">
        
        Testing the mongocxx driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/testing-legacy/">
        
        Testing the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/">
        
        Contribution Guidelines
    </a>
  </li>


        
        
    </ul>
  </li>


          
        </ul>
        
    </div>
  </div>
  

</aside>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/mongo-cxx-driver/blob/master/docs/content/mongocxx-v3/api-abi-versioning.md" target="_blank" title="Edit mongocxx-v3/api-abi-versioning.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  
  
  <li><a href="/mongocxx-v3/">mongocxx (v3)</a> <i class="fa fa-angle-right"></i></li>
  <li>API and ABI versioning</li>
</ul>
</div>


<h1>API and ABI versioning</h1>
<h2 id="api-versioning">API Versioning</h2>
<ul>
<li>We use <a href="http://semver.org/">semantic versioning</a>.</li>
<li>bsoncxx and mongocxx both define corresponding CMake variables for MAJOR, MINOR, and PATCH.</li>
</ul>
<h2 id="abi-versioning">ABI Versioning</h2>
<ul>
<li>Both bsoncxx and mongocxx both have a single scalar ABI version.</li>
<li>Only bump ABI version on <strong>incompatible</strong> ABI change (not for ABI additions).</li>
<li><strong>We stay on ABI version _noabi (without bumping for incompatible changes) until ABI is stable.</strong></li>
</ul>
<h2 id="parallel-header-installation">Parallel Header Installation</h2>
<ul>
<li>For mongocxx, install all headers to <code>$PREFIX/mongocxx/v$ABI/</code>.</li>
<li>For bsoncxx, install all headers to <code>$PREFIX/bsoncxx/v$ABI/</code>.</li>
<li>We install a pkg-config file to shield consumers from this complexity.</li>
</ul>
<h2 id="sonames-and-symlinks">Sonames and symlinks</h2>
<p><em>Note that below examples are given for libmongocxx, but also apply to libbsoncxx</em></p>
<p><em>DSO = Dynamic Shared Object, to use Ulrich Drepper&rsquo;s terminology</em></p>
<h3 id="windows-msvc-only">Windows (MSVC only)</h3>
<p>Since version 3.10.0, the physical filename for CXX Driver libraries is different
from other platforms when built with the MSVC toolchain on Windows
(even when the CMake generator is not Visual Studio).
To restore prior behavior, which is similar to other platforms, set <code>ENABLE_ABI_TAG_IN_LIBRARY_FILENAMES=OFF</code>.</p>
<ul>
<li>Physical filename for a DSO is <code>mongocxx-$ABI-$TAG.dll</code></li>
<li>Physical filename for a static library is <code>mongocxx-static-$TAG.lib</code></li>
</ul>
<p>Where <code>$TAG</code> is a triplet of letters indicating:</p>
<ul>
<li>Build Type</li>
<li>mongoc Link Type</li>
<li>Polyfill Library</li>
</ul>
<p>followed by a suffix describing the toolset and runtime library used to build the library.</p>
<p>Some examples of common DSO filenames expected to be generated include:</p>
<ul>
<li><code>mongocxx-v_noabi-rhs-x64-v142-md.dll</code> (release build configuration)</li>
<li><code>mongocxx-v_noabi-dhs-x64-v142-mdd.dll</code> (debug build configuration)</li>
<li><code>mongocxx-v_noabi-rts-x64-v142-md.dll</code> (link with mongoc statically)</li>
<li><code>mongocxx-v_noabi-rhi-x64-v142-md.dll</code> (bsoncxx polyfill library)</li>
<li><code>mongocxx-v_noabi-rhm-x64-v142-md.dll</code> (mnmlstc/core polyfill library)</li>
<li><code>mongocxx-v_noabi-rhb-x64-v142-md.dll</code> (Boost polyfill library)</li>
</ul>
<p>This allows libraries built with different build configurations (and different runtime library requirements) to be built and installed without conflicting with each other.</p>
<p>See references to <code>ENABLE_ABI_TAG_IN_LIBRARY_FILENAMES</code> and related code in the CMake configuration for more details.</p>
<h3 id="other-platforms-linux-macos">Other Platforms (Linux, MacOS)</h3>
<ul>
<li>Physical filename for a DSO is <code>libmongocxx.so.$MAJOR.$MINOR.$PATCH</code></li>
</ul>
<p>Note that the physical filename is disconnected from ABI version/soname.
This looks a bit strange, but allows multiple versions of the library with
the same ABI version to be installed on the same system.</p>
<ul>
<li>soname for a DSO is <code>libmongocxx.$ABI</code></li>
</ul>
<p>We provide a soname symlink that links to the physical DSO.  We also
provide a dev symlink that links to the soname symlink of the highest ABI
version of the library installed.</p>
<h2 id="inline-namespaces">Inline namespaces</h2>
<ul>
<li>We provide inline namespace macros for both mongocxx and bsoncxx.</li>
<li>This allows multiple, ABI incompatible versions of the library to be linked into the same application.</li>
<li>The name of the namespace is <code>v$ABI</code>. We create them from ABI version to maintain forwards compatibibility.</li>
</ul>
<h2 id="deprecation">Deprecation</h2>
<p>Occasionally we will phase features out of use in the driver.
In the release that marks a feature as deprecated we offer several transition options:</p>
<ol>
<li>The original method, marked with <code>MONGOCXX_DEPRECATED</code>. This
will raise deprecation warnings when compiled.</li>
<li>A variant of the feature suffixed with <code>_deprecated</code>. This will require only small
code changes and will not raise deprecation warnings.</li>
<li>A new feature that provides alternate functionality.
The new feature may not be a drop-in replacement for the deprecated feature and
switching to it may require code changes. In the rare case where we
remove a feature without replacing it, this third option will not be available.</li>
</ol>
<p>In the following release, the original feature marked with <code>MONGOCXX_DEPRECATED</code> and its
suffixed <code>_deprecated</code> equivalent will be removed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#75715e">// release 1 with a supported feature
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">do_thing</span>();

<span style="color:#75715e">// release 2 where the feature is deprecated in favor of a new feature
</span><span style="color:#75715e"></span>MONGOCXX_DEPRECATED <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">do_thing</span>();
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">do_thing_deprecated</span>();
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">do_new_thing</span>();

<span style="color:#75715e">// release 3 where the original feature is removed
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">do_new_thing</span>();
</code></pre></div><p>In the case of a feature rename we do not offer a suffixed <code>_deprecated</code> variant,
as one can simply switch to using the new name with the same amount of effort.</p>
<pre tabindex="0"><code>// release 1 with a supported feature
void do_thing();

// release 2 where the feature name is renamed
MONGOCXX_DEPRECATED void do_thing();
void do_stuff();

// release 3 where the original feature name is removed
void do_stuff();
</code></pre>





<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/mongocxx-v3/working-with-bson/">
      <i class="fa fa-long-arrow-left"> </i> Working with BSON
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/mongocxx-v3/">
    The mongocxx (v3) driver <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#api-versioning">API Versioning</a></li>
    <li><a href="#abi-versioning">ABI Versioning</a></li>
    <li><a href="#parallel-header-installation">Parallel Header Installation</a></li>
    <li><a href="#sonames-and-symlinks">Sonames and symlinks</a>
      <ul>
        <li><a href="#windows-msvc-only">Windows (MSVC only)</a></li>
        <li><a href="#other-platforms-linux-macos">Other Platforms (Linux, MacOS)</a></li>
      </ul>
    </li>
    <li><a href="#inline-namespaces">Inline namespaces</a></li>
    <li><a href="#deprecation">Deprecation</a></li>
  </ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "https://mongocxx.org",
   VERSION:      null ,
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="https://mongocxx.org/js/jquery.js"></script>
<script type="text/javascript" src="https://mongocxx.org/lib/bootstrap.js"></script>
<script type="text/javascript" src="https://mongocxx.org/js/navbar.js"></script>
<script type="text/javascript" src="https://mongocxx.org/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="https://mongocxx.org/js/scripts.js"></script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-JQHP"
                 height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
  {'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-JQHP');</script>


<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '413370795']);
_elqQ.push(['elqTrackPageView']);
(function () {
function async_load()
{ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//img03.en25.com/i/elqCfg.min.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }
if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-7301842-14"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-7301842-14');
</script>


<script type="text/javascript">
  !function(e,t,r,n,a){if(!e[a]){for(var i=e[a]=[],s=0;s<r.length;s++){var c=r[s];i[c]=i[c]||function(e){return function(){var t=Array.prototype.slice.call(arguments);i.push([e,t])}}(c)}i.SNIPPET_VERSION="1.0.1";var o=t.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://d2yyd1h5u9mauk.cloudfront.net/integrations/web/v1/library/"+n+"/"+a+".js";var l=t.getElementsByTagName("script")[0];l.parentNode.insertBefore(o,l)}}(window,document,["survey","reset","config","init","set","get","event","identify","track","page","screen","group","alias"],"Dk30CC86ba0nATlK","delighted");

  delighted.survey();
</script>
</body>
</html>

