<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <link rel="shortcut icon" href="https://mongocxx.org/img/favicon.png">

    <title>Advanced Configuration and Installation Options</title>

    <link rel="stylesheet" href="https://mongocxx.org/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="https://mongocxx.org/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="https://mongocxx.org/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="https://mongocxx.org/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="https://mongocxx.org/lib/highlight/styles/idea.css" />

  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="https://mongocxx.org">
        <img src="https://mongocxx.org/img/logo-mongodb-header.png",
             alt="MongoDB C++ driver" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search">
    <input type="hidden" name="site" value="https://mongocxx.org">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="https://mongocxx.org">MongoDB C&#43;&#43; Driver Manual</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
      
      
      
    
    
  
  


        
      
    
    
  


        
      
    
      
      
        
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  
    
    
      
      
    
      
      
    
      
      
    
    
  


          

          

          
            
            













  




<li class="toctree-l1  current">
  <a href="/mongocxx-v3/" class="">
      <i class='fa fa-arrow-right'></i>
      <span>mongocxx (v3)</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/polyfill-selection/">
        
        Choosing a C&#43;&#43;17 Polyfill
    </a>
  </li>


        
        
        
        
        













  




<li class="toctree-l2  current">
  <a href="/mongocxx-v3/installation/" class="">
      
      <span>Installing the mongocxx driver</span>
      
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongocxx-v3/installation/windows/">
        
        Windows
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongocxx-v3/installation/macos/">
        
        macOS
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongocxx-v3/installation/linux/">
        
        Linux
    </a>
  </li>


        
        
        
        
        













  




    <li class="toctree-l3">
    <a href="/mongocxx-v3/installation/advanced/">
        
        Advanced Configuration and Installation Options
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/configuration/">
        
        Configuring the mongocxx driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/client-side-encryption/">
        
        Client-Side Field Level Encryption with mongocxx
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/tutorial/">
        
        Tutorial for mongocxx
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/thread-safety/">
        
        Thread and fork safety
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/connection-pools/">
        
        Connection pools
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/working-with-bson/">
        
        Working with BSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/api-abi-versioning/">
        
        API and ABI versioning
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/">
        
        The mongocxx (v3) driver
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/legacy-v1/" class="">
      <i class='fa fa-arrow-right'></i>
      <span>legacy (v1)</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/installation/">
        
        Installing the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/configuration/">
        
        Configuring the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/tutorial/">
        
        Legacy driver tutorial
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/working-with-bson/">
        
        Working with BSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/breaking-changes/">
        
        Breaking changes from 26compat
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/">
        
        The Legacy C&#43;&#43; Driver
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://mongocxx.org/api/current">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/getting-help/">
        <i class='fa fa-question'></i>
        Getting help
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/reporting-bugs/">
        <i class='fa fa-bug'></i>
        Reporting Bugs
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb/mongo-cxx-driver/">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/contributing/" class="">
      <i class='fa fa-pencil'></i>
      <span>Contributing</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/testing-mongocxx/">
        
        Testing the mongocxx driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/testing-legacy/">
        
        Testing the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/">
        
        Contribution Guidelines
    </a>
  </li>


        
        
    </ul>
  </li>


          
        </ul>
        
    </div>
  </div>
  

</aside>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/mongo-cxx-driver/blob/master/docs/content/mongocxx-v3/installation/advanced.md" target="_blank" title="Edit mongocxx-v3/installation/advanced.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  
  <li><a href="/mongocxx-v3/">mongocxx (v3)</a> <i class="fa fa-angle-right"></i></li>
  <li><a href="/mongocxx-v3/installation/">Installing the mongocxx driver</a> <i class="fa fa-angle-right"></i></li>
  <li>Advanced Configuration and Installation Options</li>
</ul>
</div>


<h1>Advanced Configuration and Installation Options</h1>
<h2 id="additional-options-for-integrators">Additional Options for Integrators</h2>
<p>In the event that you are building the BSON C++ library and/or the C++ driver to embed with other components and you wish to avoid the potential for collision with components installed from a standard build or from a distribution package manager, you can make use of the <code>BSONCXX_OUTPUT_BASENAME</code> and <code>MONGOCXX_OUTPUT_BASENAME</code> options to <code>cmake</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake ..                                            <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DBSONCXX_OUTPUT_BASENAME<span style="color:#f92672">=</span>custom_bsoncxx        <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DMONGOCXX_OUTPUT_BASENAME<span style="color:#f92672">=</span>custom_mongocxx
</code></pre></div><p>The above command would produce libraries named <code>libcustom_bsoncxx.so</code> and <code>libcustom_mongocxx.so</code> (or with the extension appropriate for the build platform).  Those libraries could be placed in a standard system directory or in an alternate location and could be linked to by specifying something like <code>-lcustom_mongocxx -lcustom_bsoncxx</code> on the linker command line (possibly adjusting the specific flags to those required by your linker).</p>
<h2 id="installing-the-mongodb-c-driver">Installing the MongoDB C driver.</h2>
<p>The mongocxx driver builds on top of the <a href="https://www.mongodb.com/docs/drivers/c/">MongoDB C driver</a>.</p>
<p>The build of mongocxx-3.9.0 automatically downloads and installs the C driver if the C driver is not detected.
To use an existing install of the C driver, set <code>CMAKE_PREFIX_PATH</code> to the directory containing the C driver install.</p>
<ul>
<li>For mongocxx-3.10.x, libmongoc 1.26.0 or later is required.</li>
<li>For mongocxx-3.9.x, libmongoc 1.25.0 or later is required.</li>
<li>For mongocxx-3.8.x, libmongoc 1.24.0 or later is required.</li>
<li>For mongocxx-3.7.x, libmongoc 1.22.1 or later is required.</li>
<li>For mongocxx-3.6.x, libmongoc 1.17.0 or later is required.</li>
<li>For mongocxx-3.5.x, libmongoc 1.15.0 or later is required.</li>
<li>For mongocxx-3.4.x, libmongoc 1.13.0 or later is required.</li>
<li>For mongocxx-3.3.x, libmongoc 1.10.1 or later is required.</li>
<li>For mongocxx-3.2.x, libmongoc 1.9.2 or later is required.</li>
<li>For mongocxx-3.1.4+, libmongoc 1.7.0 or later is required.</li>
<li>For mongocxx-3.1.[0-3], libmongoc 1.5.0 or later is required.</li>
<li>For mongocxx-3.0.x, we recommend the last 1.4.x version of libmongoc</li>
</ul>
<p>Unless you know that your package manager offers a sufficiently recent version, you
will need to download and build from the source code. Get a tarball from
the <a href="https://github.com/mongodb/mongo-c-driver/releases">C Driver releases</a>
page.</p>
<p>Follow the instructions for building from a tarball at
<a href="http://mongoc.org/libmongoc/current/installing.html">Installing libmongoc</a>.</p>
<p>Industry best practices and some regulations require the use of TLS 1.1
or newer. The MongoDB C Driver supports TLS 1.1 on Linux if OpenSSL is
at least version 1.0.1. On macOS and Windows, the C Driver uses native
TLS implementations that support TLS 1.1.</p>
<h2 id="advanced-configuration-static-configurations">Advanced configuration (static configurations)</h2>
<p>The following sub-sections detail advanced options for configuring the C++ driver and/or its
dependencies as static libraries rather than the typical shared libraries.  These options will
produce library artifacts that will behave differently.  Ensure you have a complete understanding
of the implications of the various linking approaches before utilizing these options.</p>
<h3 id="configuring-with-mongocxx-32x-or-newer">Configuring with <code>mongocxx</code> 3.2.x or newer</h3>
<p>Users have the option to build <code>mongocxx</code> as a static library. <strong>This is not recommended for novice
users.</strong> A user can enable this behavior with the <code>-DBUILD_SHARED_LIBS</code> option:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake ..                                            <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_BUILD_TYPE<span style="color:#f92672">=</span>Release                      <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DBUILD_SHARED_LIBS<span style="color:#f92672">=</span>OFF
</code></pre></div><h3 id="configuring-with-mongocxx-350-or-newer">Configuring with <code>mongocxx</code> 3.5.0 or newer</h3>
<p>Users have the option to build <code>mongocxx</code> as both static and shared libraries. A user can enable
this behavior with the <code>-DBUILD_SHARED_AND_STATIC_LIBS</code> option:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake ..                                            <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_BUILD_TYPE<span style="color:#f92672">=</span>Release                      <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DBUILD_SHARED_AND_STATIC_LIBS<span style="color:#f92672">=</span>ON
</code></pre></div><p>Users have the option to build <code>mongocxx</code> as a shared library that has statically linked
<code>libmongoc</code>. <strong>This is not recommended for novice users.</strong> A user can enable this behavior with the
<code>-DBUILD_SHARED_LIBS_WITH_STATIC_MONGOC</code> option:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake ..                                            <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_BUILD_TYPE<span style="color:#f92672">=</span>Release                      <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DBUILD_SHARED_LIBS_WITH_STATIC_MONGOC<span style="color:#f92672">=</span>ON
</code></pre></div><h2 id="disabling-tests">Disabling tests</h2>
<p>Pass <code>-DENABLE_TESTS=OFF</code> as a cmake option to disable configuration of test targets.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake .. -DENABLE_TESTS<span style="color:#f92672">=</span>OFF
cmake --build .. --target help
<span style="color:#75715e"># No test targets are configured.</span>
</code></pre></div><h2 id="installing-to-non-standard-directories">Installing to non-standard directories</h2>
<p>To install the C++ driver to a non-standard directory, specify <code>CMAKE_INSTALL_PREFIX</code> to the desired
install path:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake ..                                            <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_BUILD_TYPE<span style="color:#f92672">=</span>Release                      <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_PREFIX<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver
</code></pre></div><p>Consider also specifying the <code>-DCMAKE_INSTALL_RPATH=</code> option to the <code>lib</code> directory of the install.
This may enable libmongocxx.so to locate libbsoncxx.so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake ..                                             <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_BUILD_TYPE<span style="color:#f92672">=</span>Release                       <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_PREFIX<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver    <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_RPATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver/lib
</code></pre></div><p>If the C driver is installed to a non-standard directory, specify <code>CMAKE_PREFIX_PATH</code> to the install
path of the C driver:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake ..                                            <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_BUILD_TYPE<span style="color:#f92672">=</span>Release                      <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_PREFIX_PATH<span style="color:#f92672">=</span>$HOME/mongo-c-driver        <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_PREFIX<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver
</code></pre></div><blockquote>
<p><em>Note</em> If you need multiple paths in a CMake PATH variable, separate them with a semicolon like
this:
<code>-DCMAKE_PREFIX_PATH=&quot;/your/cdriver/prefix;/some/other/path&quot;</code></p>
</blockquote>
<h3 id="configuring-with-mongocxx-31x-or-30x">Configuring with <code>mongocxx</code> 3.1.x or 3.0.x</h3>
<p>Instead of the <code>-DCMAKE_PREFIX_PATH</code> option, users must specify the <code>libmongoc</code> installation
directory by using the <code>-DLIBMONGOC_DIR</code> and <code>-DLIBBSON_DIR</code> options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cmake ..                                            <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_BUILD_TYPE<span style="color:#f92672">=</span>Release                      <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DLIBMONGOC_DIR<span style="color:#f92672">=</span>$HOME/mongo-c-driver            <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DLIBBSON_DIR<span style="color:#f92672">=</span>$HOME/mongo-c-driver              <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_PREFIX<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver
</code></pre></div><h3 id="fixing-the-library-not-loaded-error-on-macos">Fixing the &ldquo;Library not loaded&rdquo; error on macOS</h3>
<p>Applications linking to a non-standard directory installation may encounter an error loading the C++ driver at runtime. Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Tell pkg-config where to find C++ driver installation.</span>
export PKG_CONFIG_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver/lib/pkgconfig
clang++ app.cpp -std<span style="color:#f92672">=</span>c++11 <span style="color:#66d9ef">$(</span>pkg-config --cflags --libs libmongocxx<span style="color:#66d9ef">)</span> -o ./app.out
./app.out
<span style="color:#75715e"># Prints the following error:</span>
<span style="color:#75715e"># dyld[3217]: Library not loaded: &#39;@rpath/libmongocxx._noabi.dylib&#39;</span>
<span style="color:#75715e">#   Referenced from: &#39;/Users/kevin.albertson/code/app.out&#39;</span>
<span style="color:#75715e">#   Reason: tried: &#39;/usr/local/lib/libmongocxx._noabi.dylib&#39; (no such file), &#39;/usr/lib/libmongocxx._noabi.dylib&#39; (no such file)</span>
<span style="color:#75715e"># zsh: abort      ./app.out</span>
</code></pre></div><p>The default <code>install name</code> of the C++ driver on macOS includes <code>@rpath</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">otool -D $HOME/mongo-cxx-driver/lib/libmongocxx.dylib
<span style="color:#75715e"># Prints:</span>
<span style="color:#75715e"># /Users/kevin.albertson/mongo-cxx-driver/lib/libmongocxx.dylib:</span>
<span style="color:#75715e"># @rpath/libmongocxx._noabi.dylib</span>
</code></pre></div><p>Including <code>@rpath</code> in the install name allows linking applications to control the list of search paths for the library.</p>
<p><code>app.out</code> includes the load command for <code>@rpath/libmongocxx._noabi.dylib</code>. <code>app.out</code> does not have entries to substitute for <code>@rpath</code>.</p>
<p>There are several ways to consider solving this on macOS:</p>
<p>Pass <code>DYLD_FALLBACK_LIBRARY_PATH</code> to the directory containing the C++ driver libraries:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">DYLD_FALLBACK_LIBRARY_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver/lib ./app.out
<span style="color:#75715e"># Prints &#34;successfully connected with C++ driver&#34;</span>
</code></pre></div><p>Alternatively, the linker option <code>-Wl,-rpath</code> can be passed to add entries to substitute for <code>@rpath</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Tell pkg-config where to find C++ driver installation.</span>
export PKG_CONFIG_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver/lib/pkgconfig
<span style="color:#75715e"># Pass the linker option -rpath to set an rpath in the final executable.</span>
clang++ app.cpp -std<span style="color:#f92672">=</span>c++11 -Wl,-rpath,$HOME/mongo-cxx-driver/lib <span style="color:#66d9ef">$(</span>pkg-config --cflags --libs libmongocxx<span style="color:#66d9ef">)</span> -o ./app.out
./app.out
<span style="color:#75715e"># Prints &#34;successfully connected with C++ driver&#34;</span>
</code></pre></div><p>If building the application with cmake, the <a href="https://gitlab.kitware.com/cmake/community/-/wikis/doc/cmake/RPATH-handling#default-rpath-settings">Default RPATH settings</a> include the full RPATH to all used libraries in the build tree. However, when installing, cmake will clear the RPATH of these targets so they are installed with an empty RPATH. This may result in a <code>Library not loaded</code> error after install.</p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Build application `app` using the C++ driver from a non-standard install.</span>
cmake <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_PREFIX_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_PREFIX<span style="color:#f92672">=</span>$HOME/app <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_CXX_STANDARD<span style="color:#f92672">=</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -Bcmake-build -S.
cmake --build cmake-build --target app.out
<span style="color:#75715e"># Running app.out from build tree includes rpath to C++ driver.</span>
./cmake-build ./cmake-build/app.out
<span style="color:#75715e"># Prints: &#34;successfully connected with C++ driver&#34;</span>

cmake --build cmake-build --target install
<span style="color:#75715e"># Running app.out from install tree does not include rpath to C++ driver.</span>
$HOME/app/bin/app.out
<span style="color:#75715e"># Prints &#34;Library not loaded&#34; error.</span>
</code></pre></div><p>Consider setting <code>-DCMAKE_INSTALL_RPATH_USE_LINK_PATH=TRUE</code> so the rpath for the executable is kept in the install target.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Build application `app` using the C++ driver from a non-standard install.</span>
<span style="color:#75715e"># Use CMAKE_INSTALL_RPATH_USE_LINK_PATH=TRUE to keep rpath entry on installed app.</span>
cmake <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_PREFIX_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_PREFIX<span style="color:#f92672">=</span>$HOME/app <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_RPATH_USE_LINK_PATH<span style="color:#f92672">=</span>TRUE <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_CXX_STANDARD<span style="color:#f92672">=</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -Bcmake-build -S.

cmake --build cmake-build --target install
$HOME/app/bin/app.out
<span style="color:#75715e"># Prints &#34;successfully connected with C++ driver&#34;</span>
</code></pre></div><p>See the cmake documentation for <a href="https://gitlab.kitware.com/cmake/community/-/wikis/doc/cmake/RPATH-handling">RPATH handling</a> for more information.</p>
<h3 id="fixing-the-cannot-open-shared-object-file-error-on-linux">Fixing the &ldquo;cannot open shared object file&rdquo; error on Linux</h3>
<p>Applications linking to a non-standard directory installation may encounter an error loading the C++ driver at runtime. Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Tell pkg-config where to find C++ driver installation.</span>
export PKG_CONFIG_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver/lib/pkgconfig
g++ -std<span style="color:#f92672">=</span>c++11 app.cpp <span style="color:#66d9ef">$(</span>pkg-config --cflags --libs libmongocxx<span style="color:#66d9ef">)</span> -o ./app.out
./app.out
<span style="color:#75715e"># Prints the following error:</span>
<span style="color:#75715e"># ./app.out: error while loading shared libraries: libmongocxx.so._noabi: cannot open shared object file: No such file or directory</span>
</code></pre></div><p>There are several ways to consider solving this on Linux:</p>
<p>Pass <code>LD_LIBRARY_PATH</code> to the directory containing the C++ driver libraries:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">LD_LIBRARY_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver/lib ./app.out
<span style="color:#75715e"># Prints &#34;successfully connected with C++ driver&#34;</span>
</code></pre></div><p>Alternatively, the linker option <code>-Wl,-rpath</code> can be passed to add <code>rpath</code> entries:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Tell pkg-config where to find C++ driver installation.</span>
export PKG_CONFIG_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver/lib/pkgconfig
<span style="color:#75715e"># Pass the linker option -rpath to set an rpath in the final executable.</span>
g++ app.cpp -std<span style="color:#f92672">=</span>c++11 -Wl,-rpath,$HOME/mongo-cxx-driver/lib <span style="color:#66d9ef">$(</span>pkg-config --cflags --libs libmongocxx<span style="color:#66d9ef">)</span> -o ./app.out
./app.out
<span style="color:#75715e"># Prints &#34;successfully connected with C++ driver&#34;</span>
</code></pre></div><p>If building the application with cmake, the <a href="https://gitlab.kitware.com/cmake/community/-/wikis/doc/cmake/RPATH-handling#default-rpath-settings">Default RPATH settings</a> include the full RPATH to all used libraries in the build tree. However, when installing, cmake will clear the RPATH of these targets so they are installed with an empty RPATH. This may result in a <code>Library not loaded</code> error after install.</p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Build application `app` using the C++ driver from a non-standard install.</span>
cmake <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_PREFIX_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_PREFIX<span style="color:#f92672">=</span>$HOME/app <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_CXX_STANDARD<span style="color:#f92672">=</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -Bcmake-build -S.
cmake --build cmake-build --target app.out
<span style="color:#75715e"># Running app.out from build tree includes rpath to C++ driver.</span>
./cmake-build ./cmake-build/app.out
<span style="color:#75715e"># Prints: &#34;successfully connected with C++ driver&#34;</span>

cmake --build cmake-build --target install
<span style="color:#75715e"># Running app.out from install tree does not include rpath to C++ driver.</span>
$HOME/app/bin/app.out
<span style="color:#75715e"># Prints &#34;cannot open shared object file&#34; error.</span>
</code></pre></div><p>Consider setting <code>-DCMAKE_INSTALL_RPATH_USE_LINK_PATH=TRUE</code> so the rpath for the executable is kept in the install target.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Build application `app` using the C++ driver from a non-standard install.</span>
<span style="color:#75715e"># Use CMAKE_INSTALL_RPATH_USE_LINK_PATH=TRUE to keep rpath entry on installed app.</span>
cmake <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_PREFIX_PATH<span style="color:#f92672">=</span>$HOME/mongo-cxx-driver <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_PREFIX<span style="color:#f92672">=</span>$HOME/app <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_INSTALL_RPATH_USE_LINK_PATH<span style="color:#f92672">=</span>TRUE <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -DCMAKE_CXX_STANDARD<span style="color:#f92672">=</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -Bcmake-build -S.

cmake --build cmake-build --target install
$HOME/app/bin/app.out
<span style="color:#75715e"># Prints &#34;successfully connected with C++ driver&#34;</span>
</code></pre></div><p>See the cmake documentation for <a href="https://gitlab.kitware.com/cmake/community/-/wikis/doc/cmake/RPATH-handling">RPATH handling</a> for more information.</p>






<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/mongocxx-v3/installation/linux/">
      <i class="fa fa-long-arrow-left"> </i> Linux
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/mongocxx-v3/configuration/">
    Configuring the mongocxx driver <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#additional-options-for-integrators">Additional Options for Integrators</a></li>
    <li><a href="#installing-the-mongodb-c-driver">Installing the MongoDB C driver.</a></li>
    <li><a href="#advanced-configuration-static-configurations">Advanced configuration (static configurations)</a>
      <ul>
        <li><a href="#configuring-with-mongocxx-32x-or-newer">Configuring with <code>mongocxx</code> 3.2.x or newer</a></li>
        <li><a href="#configuring-with-mongocxx-350-or-newer">Configuring with <code>mongocxx</code> 3.5.0 or newer</a></li>
      </ul>
    </li>
    <li><a href="#disabling-tests">Disabling tests</a></li>
    <li><a href="#installing-to-non-standard-directories">Installing to non-standard directories</a>
      <ul>
        <li><a href="#configuring-with-mongocxx-31x-or-30x">Configuring with <code>mongocxx</code> 3.1.x or 3.0.x</a></li>
        <li><a href="#fixing-the-library-not-loaded-error-on-macos">Fixing the &ldquo;Library not loaded&rdquo; error on macOS</a></li>
        <li><a href="#fixing-the-cannot-open-shared-object-file-error-on-linux">Fixing the &ldquo;cannot open shared object file&rdquo; error on Linux</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "https://mongocxx.org",
   VERSION:      null ,
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="https://mongocxx.org/js/jquery.js"></script>
<script type="text/javascript" src="https://mongocxx.org/lib/bootstrap.js"></script>
<script type="text/javascript" src="https://mongocxx.org/js/navbar.js"></script>
<script type="text/javascript" src="https://mongocxx.org/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="https://mongocxx.org/js/scripts.js"></script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-JQHP"
                 height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
  {'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-JQHP');</script>


<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '413370795']);
_elqQ.push(['elqTrackPageView']);
(function () {
function async_load()
{ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//img03.en25.com/i/elqCfg.min.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }
if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-7301842-14"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-7301842-14');
</script>


<script type="text/javascript">
  !function(e,t,r,n,a){if(!e[a]){for(var i=e[a]=[],s=0;s<r.length;s++){var c=r[s];i[c]=i[c]||function(e){return function(){var t=Array.prototype.slice.call(arguments);i.push([e,t])}}(c)}i.SNIPPET_VERSION="1.0.1";var o=t.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://d2yyd1h5u9mauk.cloudfront.net/integrations/web/v1/library/"+n+"/"+a+".js";var l=t.getElementsByTagName("script")[0];l.parentNode.insertBefore(o,l)}}(window,document,["survey","reset","config","init","set","get","event","identify","track","page","screen","group","alias"],"Dk30CC86ba0nATlK","delighted");

  delighted.survey();
</script>
</body>
</html>

